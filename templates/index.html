<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seed Counting Portal</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}?v=2">
</head>
<body>

    <div class="container text-center mt-4">
        <h1>SMART SEED COUNTER</h1>
        <h2 class="subheading">Upload Seed Image for Counting</h2>

        {% if error %}
            <p class="alert alert-danger">{{ error }}</p>
        {% endif %}

        <form method="POST" enctype="multipart/form-data" class="mt-3">
            <label class="form-label">Select Seed Type:</label>
            <select name="seed_type" class="form-select mb-3">
                <option value="rice">Rice</option>
                <option value="maize">Maize</option>
                <option value="millet">Finger Millet</option>
            </select>

            <label class="form-label">Upload Image:</label>
            <input type="file" name="file" accept=".png, .jpg, .jpeg, .pdf" class="form-control mb-3" id="fileInput" required>
            
            <div class="text-center">
                <img id="previewImage" src="#" class="uploaded-image d-none img-thumbnail mt-3">
            </div>

            <button type="submit" class="btn btn-primary w-100 mt-3 fw-bold fs-4">Upload</button>
        </form>

        <div id="loader" class="mt-4 d-none">
            <div class="spinner-border text-primary" role="status"></div>
            <p>Processing, please wait...</p>
        </div>

        {% if image_filename %}
            <h2 class="mt-4">Uploaded Image:</h2>
            <img src="{{ url_for('uploaded_file', filename=image_filename) }}" alt="Uploaded Seed Image" class="uploaded-image img-thumbnail">
        {% endif %}

        {% if processed_image_filename %}
            <h2 class="mt-4">Processed Image with Seed Markings:</h2>
            <img src="{{ url_for('processed_file', filename=processed_image_filename) }}" alt="Processed Seed Image" class="processed-image img-thumbnail">
        {% endif %}

        {% if seed_count is not none %}
            <h2 class="mt-4 text-success">Detected {{ seed_type }} seeds: {{ seed_count }}</h2>
        {% endif %}

        <div class="note mt-4">
            <h3>ğŸ“¢ Important Notes on Image Capture:</h3>
            <ul>
                <li>ğŸ“¸ Capture the image of the seeds on a white background.</li>
                <li>âš ï¸ Ensure seeds maintain some distance from each other for accurate counting.</li>
                <li>â˜€ï¸ Avoid shadows while capturing the image.</li>
                <li>ğŸ“± Use a document scanner app for better clarity.</li>
            </ul>
        </div>

        <footer class="mt-4">
            <p>Created by <b>Savirigana Prasanth</b></p>
            <p>ğŸ“§ <a href="mailto:saviriganaprasanth2826@gmail.com">saviriganaprasanth2826@gmail.com</a></p>
            <p>ğŸ™ <a href="https://github.com/Prasanth535">github.com/Prasanth535</a></p>
            <p>ğŸ”— <a href="https://www.linkedin.com/in/savirigana-prasanth-1552701a7">LinkedIn Profile</a></p>
        </footer>
    </div>

    <script>
        document.getElementById('fileInput').addEventListener('change', function(event) {
            var reader = new FileReader();
            reader.onload = function(){
                var img = document.getElementById('previewImage');
                img.src = reader.result;
                img.classList.remove("d-none");
            };
            reader.readAsDataURL(event.target.files[0]);
        });

        document.querySelector("form").addEventListener("submit", function() {
            document.getElementById("loader").classList.remove("d-none");
        });
    </script>

</body>
</html>
